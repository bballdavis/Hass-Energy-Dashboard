{"version":3,"file":"energy-dashboard.js","sources":["src/energy-dashboard-entity-card-editor.ts","src/register.ts"],"sourcesContent":["import { LitElement, html, css } from 'lit';\r\nimport { EnergyDashboardConfig } from './types';\r\n\r\n// Extend HTMLInputElement to include the configValue property\r\ninterface CustomHTMLInputElement extends HTMLInputElement {\r\n  configValue?: string;\r\n}\r\n\r\nexport class EnergyDashboardEntityCardEditor extends LitElement {\r\n  // Explicit property declarations for TypeScript\r\n  hass: any;\r\n  config: EnergyDashboardConfig;\r\n\r\n  static get properties() {\r\n    return {\r\n      hass: { type: Object },\r\n      config: { type: Object }\r\n    };\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.hass = undefined;\r\n    this.config = undefined as unknown as EnergyDashboardConfig;\r\n  }\r\n\r\n  static get styles() {\r\n    return css`\r\n      .form {\r\n        display: flex;\r\n        flex-direction: column;\r\n      }\r\n      .row {\r\n        display: flex;\r\n        flex-direction: row;\r\n        align-items: center;\r\n        padding: 8px 16px;\r\n      }\r\n      .title {\r\n        padding-left: 16px;\r\n        margin-top: 8px;\r\n        font-weight: 500;\r\n      }\r\n      .value {\r\n        width: 100%;\r\n      }\r\n      ha-switch {\r\n        margin-right: 16px;\r\n      }\r\n    `;\r\n  }\r\n\r\n  setConfig(config: EnergyDashboardConfig) {\r\n    this.config = {\r\n      // First spread the provided config\r\n      ...config,\r\n      // Then apply defaults for any missing properties\r\n      show_header: config.show_header !== undefined ? config.show_header : true,\r\n      show_state: config.show_state !== undefined ? config.show_state : true,\r\n      show_toggle: config.show_toggle !== undefined ? config.show_toggle : true,\r\n      auto_select_count: config.auto_select_count !== undefined ? config.auto_select_count : 6,\r\n      max_height: config.max_height !== undefined ? config.max_height : 400, // Default to ~15 entities\r\n      show_energy_section: config.show_energy_section !== undefined ? config.show_energy_section : true,\r\n      energy_auto_select_count: config.energy_auto_select_count !== undefined ? config.energy_auto_select_count : 6,\r\n      title: config.title !== undefined ? config.title : 'Energy Dashboard',\r\n    };\r\n  }\r\n\r\n  valueChanged(ev: Event) {\r\n    if (!this.config) return;\r\n    const target = ev.target as CustomHTMLInputElement;\r\n    const configValue = target.configValue;\r\n    if (!configValue) return;\r\n\r\n    let newValue;\r\n    if (typeof target.checked === 'boolean') {\r\n      newValue = target.checked;\r\n    } else if (target.value !== undefined) {\r\n      if (target.type === 'number') {\r\n        newValue = Number(target.value);\r\n      } else {\r\n        newValue = target.value;\r\n      }\r\n    }\r\n\r\n    if (this.config[configValue] === newValue) return;\r\n\r\n    const newConfig = {\r\n      ...this.config,\r\n      [configValue]: newValue\r\n    };\r\n\r\n    this.dispatchEvent(new CustomEvent('config-changed', {\r\n      detail: { config: newConfig },\r\n      bubbles: true,\r\n      composed: true\r\n    }));\r\n  }\r\n\r\n  render() {\r\n    if (!this.config) return html``;\r\n\r\n    return html`\r\n      <div class=\"form\">\r\n        <div class=\"title\">Card Settings</div>\r\n\r\n        <div class=\"row\">\r\n          <ha-textfield\r\n            label=\"Title\"\r\n            .value=\"${this.config.title || ''}\"\r\n            .configValue=\"title\"\r\n            @change=\"${this.valueChanged}\"\r\n            class=\"value\"\r\n          ></ha-textfield>\r\n        </div>\r\n\r\n        <div class=\"row\">\r\n          <ha-switch\r\n            .checked=${this.config.show_header !== false}\r\n            .configValue=\"show_header\"\r\n            @change=\"${this.valueChanged}\"\r\n          ></ha-switch>\r\n          <div>Show Header</div>\r\n        </div>\r\n\r\n        <div class=\"row\">\r\n          <ha-switch\r\n            .checked=${this.config.show_state !== false}\r\n            .configValue=\"show_state\"\r\n            @change=\"${this.valueChanged}\"\r\n          ></ha-switch>\r\n          <div>Show State</div>\r\n        </div>\r\n\r\n        <div class=\"row\">\r\n          <ha-switch\r\n            .checked=${this.config.show_toggle !== false}\r\n            .configValue=\"show_toggle\"\r\n            @change=\"${this.valueChanged}\"\r\n          ></ha-switch>\r\n          <div>Allow Toggling</div>\r\n        </div>\r\n\r\n        <div class=\"row\">\r\n          <ha-textfield\r\n            label=\"Auto-select Count\"\r\n            type=\"number\"\r\n            min=\"0\"\r\n            max=\"50\"\r\n            .value=\"${String(this.config.auto_select_count || 6)}\"\r\n            .configValue=\"auto_select_count\"\r\n            @change=\"${this.valueChanged}\"\r\n            class=\"value\"\r\n          ></ha-textfield>\r\n        </div>\r\n\r\n        <div class=\"row\">\r\n          <ha-textfield\r\n            label=\"Energy Auto-select Count\"\r\n            type=\"number\"\r\n            min=\"0\"\r\n            max=\"50\"\r\n            .value=\"${String(this.config.energy_auto_select_count || 6)}\"\r\n            .configValue=\"energy_auto_select_count\"\r\n            @change=\"${this.valueChanged}\"\r\n            class=\"value\"\r\n          ></ha-textfield>\r\n        </div>\r\n\r\n        <div class=\"row\">\r\n          <ha-switch\r\n            .checked=${this.config.show_energy_section !== false}\r\n            .configValue=\"show_energy_section\"\r\n            @change=\"${this.valueChanged}\"\r\n          ></ha-switch>\r\n          <div>Show Energy Section</div>\r\n        </div>\r\n\r\n        <div class=\"row\">\r\n          <ha-textfield\r\n            label=\"Max Height (0 for no limit)\"\r\n            type=\"number\"\r\n            min=\"0\"\r\n            max=\"1000\"\r\n            .value=\"${String(this.config.max_height || 0)}\"\r\n            .configValue=\"max_height\"\r\n            @change=\"${this.valueChanged}\"\r\n            class=\"value\"\r\n            helper-persistent\r\n            helper-text=\"Set maximum height in pixels (0 = no limit)\"\r\n          ></ha-textfield>\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n}\r\n\r\ncustomElements.define('energy-dashboard-entity-card-editor', EnergyDashboardEntityCardEditor);","// Declare customCards on window\r\ndeclare global {\r\n  interface Window {\r\n    customCards: any[];\r\n  }\r\n}\r\n\r\n// Using import type with side effects to prevent 'unused import' warnings\r\n// These imports are needed to ensure the web components are registered\r\nimport './energy-dashboard-entity-card';\r\nimport './energy-dashboard-entity-card-editor';\r\n\r\nwindow.customCards = window.customCards || [];\r\nwindow.customCards.push({\r\n  type: \"energy-dashboard-entity-card\",\r\n  name: \"Energy Dashboard Entity Card\",\r\n  description: \"Card that displays power (W/kW) and energy (Wh/kWh) measurement entities\",\r\n  preview: false,\r\n  documentationURL: \"https://github.com/bballdavis/Hass-Energy-Dashboard\"\r\n});\r\n"],"names":[],"mappings":"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"}